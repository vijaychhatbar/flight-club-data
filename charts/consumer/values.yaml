replicaCount: 1

image:
  repository: iceberg-consumer
  pullPolicy: IfNotPresent
  tag: latest

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext: {}

securityContext: {}

resources:
  limits:
    cpu: 2000m
    memory: 2Gi
  requests:
    cpu: 500m
    memory: 1Gi

livenessProbe:
  exec:
    command:
      - python
      - -c
      - "import os; exit(0 if os.path.exists('/proc/self') else 1)"
  initialDelaySeconds: 90
  periodSeconds: 10
  failureThreshold: 3

readinessProbe:
  exec:
    command:
      - python
      - -c
      - "import os; exit(0 if os.path.exists('/proc/self') else 1)"
  initialDelaySeconds: 60
  periodSeconds: 5
  failureThreshold: 3

config:
  KAFKA_BOOTSTRAP_SERVERS: "kafka-0.kafka.kafka.svc.cluster.local:9092,kafka-1.kafka.kafka.svc.cluster.local:9092,kafka-2.kafka.kafka.svc.cluster.local:9092"
  KAFKA_TOPIC: "flight-data"
  SCHEMA_REGISTRY_URL: "http://schema-registry-svc:8081"
  CONSUMER_GROUP_ID: "iceberg-consumer-group"
  BATCH_SIZE: "1000"
  BATCH_TIMEOUT_SECONDS: "300"
  ICEBERG_CATALOG_PATH: "/data/shared/iceberg-warehouse"
  ICEBERG_NAMESPACE: "aviation"
  ICEBERG_TABLE: "flight_data"
  LOG_LEVEL: "INFO"

initContainers:
  - name: wait-for-kafka
    image: busybox:1.36
    command:
      - sh
      - -c
      - |
        echo "Waiting for Kafka to be ready..."
        until nc -z kafka-0.kafka.kafka.svc.cluster.local 9092; do
          echo "Kafka not ready, waiting..."
          sleep 5
        done
        echo "Kafka is ready!"
  - name: wait-for-schema-registry
    image: busybox:1.36
    command:
      - sh
      - -c
      - |
        echo "Waiting for Schema Registry to be ready..."
        until nc -z schema-registry-svc 8081; do
          echo "Schema Registry not ready, waiting..."
          sleep 5
        done
        echo "Schema Registry is ready!"

volumeMounts:
  - name: shared-data
    mountPath: /data

# Use shared PVC instead of individual PVC
sharedPVC:
  enabled: true
  name: shared-data-pvc

nodeSelector: {}

tolerations: []

affinity: {}
